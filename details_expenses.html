<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Детализация расходов</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <style>
        /* (Сокращенные стили) */
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #f0f0f0;
            display: flex;
            justify-content: center;
        }

        :root {
            --alfa-red: #EE3124;
            --text-color: #333;
            --card-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            /* Цвета для категорий */
            --category-food: #EE3124;
            --category-kid: #F5A800;
            --category-transport: #007BFF;
            --category-other: #6C757D;
            --category-dynamic: #4CAF50; /* Для динамических членов */
        }

        .app-screen {
            width: 100%;
            max-width: 390px;
            background-color: white;
            min-height: 100vh;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            position: relative;
            padding-bottom: 80px;
        }

        .top-bar {
            display: flex;
            justify-content: space-between;
            padding: 8px 25px 8px 20px;
            font-size: 13px;
            font-weight: 600;
        }

        .header-nav {
            padding: 0 20px;
            background-color: white;
            padding-bottom: 20px;
        }
        .back-title {
            display: flex;
            align-items: center;
            padding: 15px 0;
            font-size: 18px;
            color: var(--text-color);
        }
        .back-arrow {
            cursor: pointer;
            margin-right: 15px;
            font-size: 20px;
        }
        .header-title {
            font-size: 20px;
            font-weight: 600;
            margin: 0;
        }
        .header-subtitle {
            font-size: 28px;
            font-weight: 600;
            margin: 0 0 10px 0;
            padding-top: 10px;
        }
        .tabs {
            display: flex;
            gap: 8px;
            margin-top: 15px;
            overflow-x: auto;
            padding-bottom: 10px;
        }
        .tab {
            padding: 6px 12px;
            border: none;
            border-radius: 18px;
            background-color: #f0f0f0;
            color: var(--text-color);
            font-size: 14px;
            cursor: pointer;
            font-weight: 500;
            white-space: nowrap;
        }
        .tab.active {
            background-color: #000;
            color: white;
        }

        .content {
            padding: 20px;
            padding-top: 0;
        }
        
        .summary-card {
            background-color: var(--alfa-red);
            color: white;
            padding: 25px 20px;
            border-radius: 20px;
            text-align: center;
            margin-bottom: 20px;
        }

        .member-card {
            background-color: white;
            border-radius: 20px;
            box-shadow: var(--card-shadow);
            margin-bottom: 25px;
            padding: 20px;
            border: 1px solid #eee;
        }

        .member-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        .member-header h3 {
            font-size: 18px;
            font-weight: 700;
            margin: 0;
            display: flex;
            align-items: center;
        }
        .member-header h3 i {
            color: var(--alfa-red);
            margin-right: 10px;
            font-size: 20px;
        }
        
        .member-header.dynamic h3 i {
            color: var(--category-dynamic); /* Зеленый для динамических */
        }

        .member-amount {
            font-size: 18px;
            font-weight: 700;
            color: var(--alfa-red);
        }

        .category-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .category-item {
            display: flex;
            justify-content: space-between;
            font-size: 15px;
            color: #555;
            padding: 8px 0;
            border-top: 1px solid #f0f0f0;
        }
        .category-item:first-child {
            border-top: none;
        }
        .category-item span:first-child {
            display: flex;
            align-items: center;
            color: var(--text-color);
        }
        .category-item i {
            font-size: 8px;
            margin-right: 8px;
        }

        .category-food i { color: var(--category-food); }
        .category-kid i { color: var(--category-kid); }
        .category-transport i { color: var(--category-transport); }
        .category-other i { color: var(--category-other); }
        .category-dynamic i { color: var(--category-dynamic); }
    </style>
</head>
<body>

<div class="app-screen">
    
    <div class="top-bar">
        <span>9:41</span>
        <div class="status-icons">
            <i class="fas fa-signal"></i>
            <i class="fas fa-wifi"></i>
            <i class="fas fa-battery-three-quarters"></i>
        </div>
    </div>

    <header class="header-nav">
        <div class="back-title">
            <i class="fas fa-chevron-left back-arrow" id="navToAnalyticsHome"></i>
            <h1 class="header-title">Октябрь</h1>
        </div>
        <h2 class="header-subtitle">Детализация расходов</h2>
        <p class="header-description">
            Подробная разбивка трат по каждому члену семьи.
        </p>

        <div class="tabs">
            <button class="tab active" id="allTab">Все</button>
            <button class="tab">Еда</button>
            <button class="tab">Ребенок</button>
            <button class="tab">Транспорт</button>
            <button class="tab">Досуг</button>
            <button class="tab">Прочее</button>
        </div>
    </header>

    <main class="content" id="memberCardsContainer">

        <div class="summary-card">
            <p>Общие расходы семьи за Октябрь:</p>
            <h2>150 000 ₽</h2>
        </div>
        
        </main>

    <nav class="bottom-nav" style="position: fixed; bottom: 0; left: 50%; transform: translateX(-50%); max-width: 390px; width: 100%; height: 70px; background-color: white; box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.05); display: flex; justify-content: space-around; align-items: center; padding-bottom: 5px; font-size: 11px; color: #888; z-index: 20;">
        <div class="nav-item" style="display: flex; flex-direction: column; align-items: center; cursor: pointer; font-weight: 500;">
            <i class="fas fa-home" style="font-size: 22px; margin-bottom: 4px;"></i>
            <span>Главный</span>
        </div>
        <div class="nav-item" style="display: flex; flex-direction: column; align-items: center; cursor: pointer; font-weight: 500;">
            <i class="fas fa-credit-card" style="font-size: 22px; margin-bottom: 4px;"></i>
            <span>Платежи</span>
        </div>
        <div class="nav-item" style="display: flex; flex-direction: column; align-items: center; cursor: pointer; font-weight: 500;">
            <i class="fas fa-heart" style="font-size: 22px; margin-bottom: 4px;"></i>
            <span>Выгода</span>
        </div>
        <div class="nav-item" style="display: flex; flex-direction: column; align-items: center; cursor: pointer; font-weight: 500; color: var(--alfa-red);">
            <i class="fas fa-history" style="font-size: 22px; margin-bottom: 4px;"></i>
            <span>История</span>
        </div>
        <div class="nav-item" style="display: flex; flex-direction: column; align-items: center; cursor: pointer; font-weight: 500;">
            <i class="fas fa-comment-dots" style="font-size: 22px; margin-bottom: 4px;"></i>
            <span>Чаты</span>
        </div>
    </nav>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const memberCardsContainer = document.getElementById('memberCardsContainer');

        // --- LOCAL STORAGE MANAGEMENT ---
        const DEFAULT_MEMBERS_CONFIG = [
            { id: 'father', name: 'Папа', icon: 'male', role: 'Основной пользователь', type: 'main', editable: true, removable: false },
            { id: 'mother', name: 'Мама', icon: 'female', role: 'Пользователь', type: 'user', editable: true, removable: false },
            { id: 'child', name: 'Ребенок', icon: 'child', role: 'Зависимый профиль', type: 'dependent', editable: true, removable: true }
        ];

        function getFamilyMembers() {
            const membersJson = localStorage.getItem('family_members');
            if (membersJson) {
                return JSON.parse(membersJson);
            }
            localStorage.setItem('family_members', JSON.stringify(DEFAULT_MEMBERS_CONFIG));
            return DEFAULT_MEMBERS_CONFIG;
        }

        // --- ШАБЛОНЫ КАРТОЧЕК (Условные данные) ---
        const EXPENSE_TEMPLATES = {
            'child': {
                amount: '30 000 ₽ (20%)',
                categories: [
                    { name: 'Детский сад', amount: '15 000 ₽', class: 'category-kid' },
                    { name: 'Игрушки', amount: '5 000 ₽', class: 'category-kid' },
                    { name: 'Питание', amount: '10 000 ₽', class: 'category-food' }
                ]
            },
            'mother': {
                amount: '52 500 ₽ (35%)',
                categories: [
                    { name: 'Продукты', amount: '25 000 ₽', class: 'category-food' },
                    { name: 'Такси', amount: '10 000 ₽', class: 'category-transport' },
                    { name: 'Одежда', amount: '17 500 ₽', class: 'category-other' }
                ]
            },
            'father': {
                amount: '67 500 ₽ (45%)',
                categories: [
                    { name: 'Топливо', amount: '30 000 ₽', class: 'category-transport' },
                    { name: 'Подписки', amount: '15 000 ₽', class: 'category-other' },
                    { name: 'Рестораны', amount: '22 500 ₽', class: 'category-food' }
                ]
            },
            'dynamic': {
                amount: '15 000 ₽ (10%)',
                categories: [
                    { name: 'Прочее (Динамика)', amount: '10 000 ₽', class: 'category-dynamic' },
                    { name: 'Кафе', amount: '5 000 ₽', class: 'category-food' }
                ]
            }
        };

        // --- ДИНАМИЧЕСКИЙ РЕНДЕРИНГ ---
        function generateCategoryListHTML(categories) {
            return categories.map(cat => `
                <li class="category-item ${cat.class || ''}">
                    <span><i class="fas fa-circle"></i> ${cat.name}</span>
                    <span>${cat.amount}</span>
                </li>
            `).join('');
        }

        function renderMemberCards() {
            const members = getFamilyMembers();
            
            // Удаляем все старые карточки, чтобы избежать дублирования
            const existingCards = document.querySelectorAll('.member-card');
            existingCards.forEach(card => card.remove());

            const summaryCard = document.querySelector('.summary-card');
            let html = '';

            members.forEach(member => {
                const templateKey = member.type === 'dynamic' ? 'dynamic' : member.id;
                const template = EXPENSE_TEMPLATES[templateKey] || EXPENSE_TEMPLATES['dynamic'];
                
                const iconClass = member.icon ? `fa-${member.icon}` : 'fa-user';
                const headerClass = member.type === 'dynamic' ? 'dynamic' : '';
                const displayAmount = (member.id in EXPENSE_TEMPLATES) ? template.amount : '... ₽ (0%)'; // Условные данные

                html += `
                    <div class="member-card" id="member_${member.id}">
                        <div class="member-header ${headerClass}">
                            <h3><i class="fas ${iconClass}"></i> <span>${member.name}</span></h3>
                            <span class="member-amount">${displayAmount}</span>
                        </div>
                        <ul class="category-list">
                            ${generateCategoryListHTML(template.categories)}
                        </ul>
                    </div>
                `;
            });
            
            if (summaryCard) {
                summaryCard.insertAdjacentHTML('afterend', html);
            } else {
                memberCardsContainer.innerHTML += html;
            }
        }
        
        // --- ИНИЦИАЛИЗАЦИЯ И НАВИГАЦИЯ ---
        renderMemberCards();

        document.getElementById('navToAnalyticsHome').addEventListener('click', () => {
            window.location.href = 'analytics_home.html'; 
        });
    });
</script>
</body>
</html>
